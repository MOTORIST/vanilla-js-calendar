!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Calendar=t():e.Calendar=t()}(this,(function(){return(()=>{"use strict";var e={254:(e,t,a)=>{a.r(t)},722:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=a(230),n=a(85),i=a(601),r=a(489),o=a(367),l=a(946),d=a(313),h=a(412);t.default=class{constructor(e,t){this.state=o.default(l.default(t)),this.view=new n.default(e,this.state),this.ee=new h.default,this.registerEvents(),this.initEventWatchers()}init(){return this.view.render(),this}on(e,t){this.ee.on(e,t)}to({year:e,month:t,date:a}){e=a&&a.getFullYear()||e||this.state.year,t=a&&a.getMonth()||t||this.state.month;const n=s.Mod.Dates,i=s.Mod.Dates;this.state.setState({year:e,month:t,mod:n,prevMod:i})}toToday(){const e=new Date;this.to({date:e})}getActiveDates(){return[...this.state.activeDates]}clearActiveDates(){this.state.setState({activeDates:new Set}),this.view.clearActiveDates(),this.ee.emit(i.EVENTS.CLEAR_ACTIVE_DATES)}initEventWatchers(){this.state.setWatchers({activeDates:[()=>this.ee.emit(i.EVENTS.CHANGE_DATA,{activeDates:[...this.state.activeDates]})]})}registerEvents(){const e=this.view.getContainer();if(!e)throw new Error("Container not rendered");e.getElement().addEventListener("click",this)}handleEvent(e){"click"===e.type&&(this.handleClickMonth(e),this.handleClickYear(e),this.handleClickViewItem(e),this.handleClickNextButton(e),this.handleClickPrevButton(e),this.handleClickToTodayButton(e),this.handleClickClearActiveDatesButton(e))}handleClickMonth(e){r.getTargetHtmlElement(e,`.${i.CLASSES.TitleMonth}`)&&this.changeMod(s.Mod.Months)}handleClickYear(e){r.getTargetHtmlElement(e,`.${i.CLASSES.TitleYear}`)&&this.changeMod(s.Mod.Years)}handleClickViewItem(e){const t=r.getTargetHtmlElement(e,`.${i.CLASSES.ViewItem}`);t&&this.getViewModInstance(t).pickValue()}handleClickNextButton(e){const t=r.getTargetHtmlElement(e,`.${i.CLASSES.NextButton}`);t&&this.getViewModInstance(t).nextView()}handleClickPrevButton(e){const t=r.getTargetHtmlElement(e,`.${i.CLASSES.PrevButton}`);t&&this.getViewModInstance(t).prevView()}handleClickToTodayButton(e){r.getTargetHtmlElement(e,`.${i.CLASSES.TodayButton}`)&&this.toToday()}handleClickClearActiveDatesButton(e){r.getTargetHtmlElement(e,`.${i.CLASSES.ClearActiveDatesButton}`)&&this.clearActiveDates()}changeMod(e,t){this.state.setState({prevMod:t||this.state.mod,mod:e})}getViewModInstance(e){return d.default(e,this.state,this.view,this.ee)}}},601:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EVENTS=t.CLASSES=void 0,t.CLASSES={Calendar:"Calendar",Wrapper:"Calendar-Wrapper",Calendar_mod_dates:"Calendar_mod_dates",Calendar_mod_months:"Calendar_mod_months",Calendar_mod_years:"Calendar_mod_years",Header:"Calendar-Header",PrevButton:"Calendar-PrevButton",NextButton:"Calendar-NextButton",Title:"Calendar-Title",TitleMonth:"Calendar-TitleMonth",TitleYear:"Calendar-TitleYear",TitleRangeYears:"Calendar-TitleRangeYears",Body:"Calendar-Body",View:"Calendar-View",View_type_dates:"Calendar-View_type_dates",View_type_months:"Calendar-View_type_months",View_type_years:"Calendar-View_type_years",ViewRow:"Calendar-ViewRow",ViewItem:"Calendar-ViewItem",ViewItem_disable:"Calendar-ViewItem_disable",ViewItem_today:"Calendar-ViewItem_today",ViewItem_status_active:"Calendar-ViewItem_status_active",Toolbar:"Calendar-Toolbar",ToolbarButton:"Calendar-ToolbarButton",TodayButton:"Calendar-TodayButton",ClearActiveDatesButton:"Calendar-ClearActiveDatesButton",WeekDays:"Calendar-WeekDays",WeekDay:"Calendar-WeekDay",Button:"Calendar-Button",Icon:"Calendar-Icon"},t.EVENTS={ADD_DATE:"addDate",REMOVE_DATE:"removeDate",CHANGE_MONTH:"changeMonth",CHANGE_YEAR:"changeYear",CHANGE_DATA:"changeData",CLEAR_ACTIVE_DATES:"clearActiveDates"}},489:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isObject=t.range=t.getTargetHtmlElement=t.isToday=t.getMonthDates=t.getWeekDaysNames=t.getMonthsNames=void 0,t.getMonthsNames=function(e=navigator.language){return new Array(12).fill(0).map(((t,a)=>new Intl.DateTimeFormat(e,{month:"long"}).format(new Date(2020,a,1))))},t.getWeekDaysNames=function(e=navigator.language,{length:t="short",weekStart:a=0}={}){let s=new Array(7).fill(5).map(((a,s)=>new Intl.DateTimeFormat(e,{weekday:t}).format(new Date(2020,0,s+a))));return 0!==a&&(s=[...s.slice(a),...s.slice(0,a)]),s},t.getMonthDates=function(e,t,a=0){const s=new Array(42),n=new Date(e,t,1),i=n.getDay()-a,r=(i>-1?i:i+7)-1;n.setDate(-r);for(let e=0;e<42;e++)s[e]={date:n.getDate(),time:n.getTime(),month:n.getMonth(),year:n.getFullYear()},n.setDate(n.getDate()+1);return s},t.isToday=function(e,t,a){const s=new Date;return s.getFullYear()===e&&s.getMonth()===t&&s.getDate()===a},t.getTargetHtmlElement=function(e,t){const a=e.target;return a instanceof Element?a.closest(t):null},t.range=function(e,t){const a=t-e+1,s=new Array(a);for(let t=0;t<a;t++)s[t]=e+t;return s},t.isObject=function(e){return e&&"object"==typeof e}},607:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=a(722);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return s.default}})},946:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=a(230),n=a(489);t.default=function(e){const t=new Date,a=e&&e.year||t.getFullYear(),i=t.getMonth(),r=e&&e.weekStart||0,o=e&&e.locale||navigator.language||"en",l=e&&e.multidate||!1,d=e&&e.mod||s.Mod.Dates;return{year:a,month:i,weekStart:r,locale:o,multidate:l,mod:d,prevMod:d,activeDates:new Set,monthNames:n.getMonthsNames(o),weekDaysNames:n.getWeekDaysNames(o,{weekStart:r})}}},367:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});class a{setState(e){Object.assign(this,e)}getState(){return this}setWatchers(e){if(this.watchers)for(let t in e){if(!e.hasOwnProperty(t))return;this.watchers[t]=this.watchers[t]?this.watchers[t].concat(e[t]):e[t]}else this.watchers=e}getWatchers(){return this.watchers}}t.default=function(e){const t=new a;return new Proxy(Object.assign(t,e||{}),{set:function(e,a,s){e[a]=s;const n=t.getWatchers();if(n){const e=n[a];e&&e.forEach((e=>e()))}return!0}})}},230:(e,t)=>{var a;Object.defineProperty(t,"__esModule",{value:!0}),t.Mod=void 0,(a=t.Mod||(t.Mod={}))[a.Dates=1]="Dates",a[a.Months=2]="Months",a[a.Years=3]="Years"},593:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Dom=void 0;class a{constructor(e){if(e instanceof HTMLElement)this.el=e;else{if("string"!=typeof e)throw new Error(`${e} must be string or HTMLElement`);{const t=document.querySelector(e);if(!t)throw new Error(`${e} - element not found`);if(!(t instanceof HTMLElement))throw new Error(`${e} - is not HTMLElement`);this.el=t}}}static createElement(e){const t=document.createElement(e);return new a(t)}getElement(){return this.el}text(e){return this.el.innerText=`${e}`,this}html(e){return this.el.innerHTML=`${e}`,this}data(e,t){return void 0===t?this.el.dataset[e]:(this.el.dataset[e]=t,this)}addClass(...e){return this.el.classList.add(...e),this}removeClass(...e){return this.el.classList.remove(...e),this}hasClass(e){return this.el.classList.contains(e)}classes(){return Array.from(this.el.classList)}addModClass(e){const t=e.split("_")[1],a=this.classes().filter((e=>{const a=e.split("_");return a.length>0&&a[1]===t}));return this.removeClass(...a).addClass(e),this}append(...e){const t=e.map((e=>e instanceof a?e.getElement():e));return this.el.append(...t),this}appendTo(e){return e instanceof a?e.getElement().append(this.el):e.append(this.el),this}closest(e){const t=this.el.closest(e);return t?s(t):null}attr(e,t){return this.el.setAttribute(e,t.toString()),this}find(e){const t=this.getElement().querySelector(e);return t?new a(t):this}}function s(e){return new a(e)}t.Dom=a,t.default=s,s.createElement=a.createElement},412:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=class{constructor(){this.events=new Map}on(e,t){const a=this.events.get(e);a?a.push(t):this.events.set(e,[t])}off(e,t){const a=this.events.get(e);if(!a)return;const s=a.indexOf(t);-1!==s&&a.splice(s,1)}emit(e,...t){const a=this.events.get(e);a&&a.forEach((e=>e(...t)))}}},163:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DatesViewMod=void 0;const s=a(601),n=a(656);class i extends n.ViewMod{pickValue(){if(this.isActiveItem)this.view.removeActiveViewItem(this.element),this.removeValueFromState(),this.ee.emit(s.EVENTS.REMOVE_DATE,this.value);else{const e=!this.state.multidate;this.view.setActiveViewItem(this.element,e),this.addValueToState(),this.ee.emit(s.EVENTS.ADD_DATE,this.value)}}nextView(){const e=this.state.month+1;if(e>11){const e=this.state.year+1,t=0;this.state.setState({month:t,year:e})}else this.state.setState({month:e})}prevView(){const e=this.state.month-1;if(e<0){const e=this.state.year-1,t=11;this.state.setState({month:t,year:e})}else this.state.setState({month:e})}addValueToState(){const e=this.state.multidate?this.state.activeDates.add(this.value):new Set([this.value]);this.state.setState({activeDates:e})}removeValueFromState(){const e=this.state.activeDates;e.delete(this.value),this.state.setState({activeDates:e})}}t.DatesViewMod=i},313:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=a(230),n=a(163),i=a(662),r=a(234);t.default=function(e,t,a,o){switch(t.mod){case s.Mod.Dates:return new n.DatesViewMod(e,t,a,o);case s.Mod.Months:return new i.MonthViewMod(e,t,a,o);case s.Mod.Years:return new r.YearsViewMod(e,t,a,o)}}},662:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MonthViewMod=void 0;const s=a(656),n=a(230),i=a(601);class r extends s.ViewMod{pickValue(){this.view.setActiveViewItem(this.element),this.changeStateValue(),this.changeMod(),this.ee.emit(i.EVENTS.CHANGE_MONTH,this.value)}nextView(){const e=this.state.year+1;this.state.setState({year:e})}prevView(){const e=this.state.year-1;this.state.setState({year:e})}changeStateValue(){this.state.setState({month:this.value})}changeMod(){const e=n.Mod.Dates,t=this.state.mod;this.state.setState({mod:e,prevMod:t})}}t.MonthViewMod=r},656:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ViewMod=void 0;const s=a(601);t.ViewMod=class{constructor(e,t,a,s){this.element=e,this.state=t,this.view=a,this.ee=s}get isActiveItem(){return this.element.classList.contains(s.CLASSES.ViewItem_status_active)}get value(){return Number.parseInt(this.element.dataset.value,10)}}},234:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.YearsViewMod=void 0;const s=a(656),n=a(230),i=a(601);class r extends s.ViewMod{pickValue(){this.view.setActiveViewItem(this.element),this.changeMod(),this.changeStateValue(),this.ee.emit(i.EVENTS.CHANGE_YEAR,this.value)}nextView(){const e=this.state.year+12;this.state.setState({year:e})}prevView(){const e=this.state.year-12;this.state.setState({year:e})}changeStateValue(){this.state.setState({year:this.value})}changeMod(){const e=this.state.prevMod===n.Mod.Months,t=e?n.Mod.Months:n.Mod.Dates,a=e?n.Mod.Years:n.Mod.Dates;this.state.setState({mod:t,prevMod:a})}}t.YearsViewMod=r},85:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0});const s=a(593),n=a(601),i=a(230),r=a(489);t.default=class{constructor(e,t){this.root=s.default(e),this.state=t,this.initElements(),this.initStateWatchers()}render(){this.container.appendTo(this.root),this.renderDatesView(),this.renderMonthsView(),this.renderYearsView()}getContainer(){return this.container}setMod(){this.container.addModClass(this.getModClass())}setActiveViewItem(e,t=!0){if(t){const t=e.closest(`.${n.CLASSES.View}`);if(!t)return;t.querySelectorAll(`.${n.CLASSES.ViewItem}`).forEach((e=>{s.default(e).removeClass(n.CLASSES.ViewItem_status_active)}))}s.default(e).addModClass(n.CLASSES.ViewItem_status_active)}removeActiveViewItem(e){s.default(e).removeClass(n.CLASSES.ViewItem_status_active)}clearActiveDates(){const e=this.datesView.getElement().querySelectorAll(`.${n.CLASSES.ViewItem}`);Array.from(e).forEach((e=>e.classList.remove(`${n.CLASSES.ViewItem_status_active}`)))}initElements(){this.container=this.createContainer(),this.datesView=this.container.find(`.${n.CLASSES.View_type_dates}`),this.monthsView=this.container.find(`.${n.CLASSES.View_type_months}`),this.yearsView=this.container.find(`.${n.CLASSES.View_type_years}`),this.titleMonth=this.container.find(`.${n.CLASSES.TitleMonth}`),this.titleYear=this.container.find(`.${n.CLASSES.TitleYear}`),this.titleRangeYears=this.container.find(`.${n.CLASSES.TitleRangeYears}`)}initStateWatchers(){this.state.setWatchers({mod:[()=>this.setMod()],month:[()=>this.setTitleMonth(),()=>this.renderDatesView()],year:[()=>this.setTitleYear(),()=>this.setTitleRangeYears(),()=>this.renderDatesView(),()=>this.renderYearsView()]})}setTitleMonth(){const e=this.state.monthNames[this.state.month];this.titleMonth.text(e)}setTitleYear(){this.titleYear.text(this.state.year)}setTitleRangeYears(){const e=this.getRangeYearsText();this.titleRangeYears.text(e)}createContainer(){const e=this.getMonthName(),t=this.state.year,a=this.getRangeYearsText();return s.default.createElement("div").addClass(n.CLASSES.Calendar,this.getModClass()).html(this.template(e,t,a))}renderDatesView(){this.datesView.html(""),this.renderWeekDays(),this.renderDates()}renderMonthsView(){this.renderMonths()}renderYearsView(){this.yearsView.html(""),this.renderYears()}renderWeekDays(){const e=s.default.createElement("div").addClass(n.CLASSES.WeekDays).appendTo(this.datesView);this.state.weekDaysNames.forEach((t=>{s.default.createElement("div").addClass(n.CLASSES.WeekDay).text(t).appendTo(e)}))}renderDates(){const e=r.getMonthDates(this.state.year,this.state.month,this.state.weekStart);for(let t=0;t<6;t++){const a=s.default.createElement("div").addClass(n.CLASSES.ViewRow).appendTo(this.datesView);e.slice(7*t,7*(t+1)).forEach((e=>{const t=e.month!==this.state.month,i=this.state.activeDates.has(e.time),r=new Date,o=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime()===e.time,l=s.default.createElement("button").addClass(n.CLASSES.ViewItem,n.CLASSES.Button).text(e.date).data("value",e.time);o&&l.addClass(n.CLASSES.ViewItem_today),t&&l.addClass(n.CLASSES.ViewItem_disable).attr("disable","disabled"),i&&!t&&l.addClass(n.CLASSES.ViewItem_status_active),l.appendTo(a)}))}}renderMonths(){const e=this.state.monthNames.map(((e,t)=>({value:t,name:e.slice(0,3)})));for(let t=0;t<3;t++){const a=s.default.createElement("div").addClass("Calendar-ViewRow").appendTo(this.monthsView);e.slice(4*t,4*(t+1)).forEach((e=>{const t=s.default.createElement("button").addClass("Calendar-ViewItem","Calendar-Button").text(e.name).data("value",e.value);e.value===this.state.month&&t.addClass(n.CLASSES.ViewItem_status_active),t.appendTo(a)}))}}renderYears(){const e=this.getRangeYears();for(let t=0;t<3;t++){const a=s.default.createElement("div").addClass("Calendar-ViewRow").appendTo(this.yearsView);e.slice(4*t,4*(t+1)).forEach((e=>{const t=s.default.createElement("button").addClass("Calendar-ViewItem","Calendar-Button").text(e).data("value",e);e===this.state.year&&t.addClass(n.CLASSES.ViewItem_status_active),t.appendTo(a)}))}}getModClass(){return{[i.Mod.Dates]:n.CLASSES.Calendar_mod_dates,[i.Mod.Months]:n.CLASSES.Calendar_mod_months,[i.Mod.Years]:n.CLASSES.Calendar_mod_years}[this.state.mod]}getMonthName(){return this.state.monthNames[this.state.month]}getRangeYears(){const e=this.state.year,t=e+11;return r.range(e,t)}getRangeYearsText(){const e=this.state.year;return`${e} - ${e+11}`}template(e,t,a){const{Wrapper:s,Header:i,Button:r,PrevButton:o,NextButton:l,Title:d,TitleMonth:h,TitleYear:c,TitleRangeYears:u,Body:m,View:v,View_type_dates:S,View_type_months:w,View_type_years:C,Toolbar:f,ToolbarButton:g,ClearActiveDatesButton:M,TodayButton:E,Icon:V}=n.CLASSES;return`\n      <div class="${s}">\n          <div class="${i}">\n            <button class="${r} ${o}"></button>\n            <div class="${d}">\n              <button class="${r} ${h}">${e}</button>\n              <button class="${r} ${c}">${t}</button>\n              <div class="${u}">${a}</div>\n            </div>\n            <button class="${r} ${l}"></button>\n          </div>\n          <div class="${m}">\n            <div class="${v} ${S}"></div>\n            <div class="${v} ${w}"></div>\n            <div class="${v} ${C}"></div>\n          </div>\n      </div>\n      <div class="${f}">\n        <button class="${r} ${g} ${E}">\n          <svg class="${V}" focusable="false" viewBox="0 0 24 24" aria-hidden="true">\n            <circle cx="12" cy="12" r="2" opacity=".3"></circle>\n            <path d="M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm8.94-3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"></path>\n          </svg>\n        </button>\n        <button class="${r} ${g} ${M}">\n          <svg class="${V}" focusable="false" viewBox="0 0 24 24" aria-hidden="true">\n            <path d="M8 9h8v10H8z" opacity=".3"></path><path d="M15.5 4l-1-1h-5l-1 1H5v2h14V4zM6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9z"></path>\n          </svg>\n        </button>\n      </div>\n    `}}}},t={};function a(s){if(t[s])return t[s].exports;var n=t[s]={exports:{}};return e[s](n,n.exports,a),n.exports}a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var s={};return(()=>{var e=s;e.default=void 0,a(254);var t=a(607);Object.defineProperty(e,"default",{enumerable:!0,get:function(){return t.default}})})(),s.default})()}));